# ML-AD-Interaction-Analysis
{
  "cells": [
    {
      "cell_type": "markdown",
      "source": [
        "# INTRODUCTION"
      ],
      "metadata": {
        "id": "O4Swz1o8npBs"
      },
      "id": "O4Swz1o8npBs"
    },
    {
      "cell_type": "markdown",
      "source": [
        "A mega-online shopping mall provides different baby brands to customers. In order to optimize online advertisements throughout websites, they want to predict the view-to-click probability given the information below.\n",
        "\n",
        "The data consists of:\n",
        "\n",
        "Action: the “interaction” that users completed when online ad was exposed. There are two types of actions in this dataset, View (a.k.a Impression) or Click. (Reference: https://en.wikipedia.org/wiki/Impression_(online_media))\n",
        "ID: unique user IDs\n",
        "Action Time: the time when action (View/Click) happened, in microseconds format\n",
        "Website: the website where the ad was published\n",
        "Banner Size: the banner size of ad\n",
        "Brand: the brand name that the ad was promoting\n",
        "Colour: the colour of product showcased in the ad\n",
        "Interaction Time: user’s interaction time with each ad (sec)\n",
        "\n",
        "Goal: Predict the Likelihood of Click"
      ],
      "metadata": {
        "id": "khWdk5pUnv7M"
      },
      "id": "khWdk5pUnv7M"
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive')"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "fscYB-A8ReL-",
        "outputId": "9645b893-035b-4802-8ae0-17a68c7fe04a"
      },
      "id": "fscYB-A8ReL-",
      "execution_count": 5,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "id": "f00aef8b",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "f00aef8b",
        "outputId": "2a1d43da-9406-4682-fcae-2d1205447184"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: SQLAlchemy in /usr/local/lib/python3.7/dist-packages (1.4.31)\n",
            "Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.7/dist-packages (from SQLAlchemy) (1.1.2)\n",
            "Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from SQLAlchemy) (4.11.0)\n",
            "Requirement already satisfied: typing-extensions>=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->SQLAlchemy) (3.10.0.2)\n",
            "Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->SQLAlchemy) (3.7.0)\n",
            "Collecting pymysql\n",
            "  Downloading PyMySQL-1.0.2-py3-none-any.whl (43 kB)\n",
            "\u001b[K     |████████████████████████████████| 43 kB 1.1 MB/s \n",
            "\u001b[?25hInstalling collected packages: pymysql\n",
            "Successfully installed pymysql-1.0.2\n"
          ]
        }
      ],
      "source": [
        "import pandas as pd\n",
        "!pip install SQLAlchemy\n",
        "!pip install pymysql\n",
        "from sqlalchemy import create_engine\n",
        "import pymysql\n",
        "import configparser\n",
        "import matplotlib.pyplot as plt\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "from sklearn.linear_model import LinearRegression\n",
        "from sklearn.preprocessing import StandardScaler,MinMaxScaler, RobustScaler\n",
        "from sklearn.metrics import classification_report\n",
        "from sklearn.model_selection import GridSearchCV\n",
        "from imblearn.pipeline import make_pipeline,Pipeline\n",
        "from sklearn.impute import SimpleImputer\n",
        "from imblearn.over_sampling import RandomOverSampler\n",
        "from sklearn.tree import DecisionTreeClassifier\n",
        "from imblearn.under_sampling import RandomUnderSampler\n",
        "from sklearn.ensemble import RandomForestClassifier\n",
        "from sklearn.tree import DecisionTreeRegressor\n",
        "from sklearn.metrics import confusion_matrix, accuracy_score, precision_recall_curve, f1_score, precision_score, recall_score"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "id": "41f8983c",
      "metadata": {
        "scrolled": false,
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 319
        },
        "id": "41f8983c",
        "outputId": "d2483b9b-a7e0-4136-b9b8-9589a89432a5"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-a0ac33a3-a8bb-4038-97a1-60c8bb1d42b9\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>ActionTime</th>\n",
              "      <th>Action</th>\n",
              "      <th>Website</th>\n",
              "      <th>BannerSize</th>\n",
              "      <th>Brand</th>\n",
              "      <th>colour</th>\n",
              "      <th>InteractionTime</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Unnamed: 0</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>AMsySZbNg8SBwPtj7IGHnip_8aY0</td>\n",
              "      <td>1508761859495365</td>\n",
              "      <td>View</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x600</td>\n",
              "      <td>Carter's</td>\n",
              "      <td>Pink</td>\n",
              "      <td>0.171601</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>AMsySZZcUFNGOJs-lfC9j-ZDlV7Z</td>\n",
              "      <td>1502847469736117</td>\n",
              "      <td>View</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Burberry</td>\n",
              "      <td>Red</td>\n",
              "      <td>4.303945</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>AMsySZYoK8_bD0hGv4zu0iRn1TFo</td>\n",
              "      <td>1514169431528120</td>\n",
              "      <td>View</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>728x90</td>\n",
              "      <td>Disney</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>0.868106</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>AMsySZahxpwLOWnMJj6RGATgwEOc</td>\n",
              "      <td>1515527952591896</td>\n",
              "      <td>View</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>320x50</td>\n",
              "      <td>Carter's</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>0.802647</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>AMsySZbqgfMBDtAqZz1jVRaOmX00</td>\n",
              "      <td>1507514809374045</td>\n",
              "      <td>View</td>\n",
              "      <td>instagram.com</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Gap</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.627148</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a0ac33a3-a8bb-4038-97a1-60c8bb1d42b9')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-a0ac33a3-a8bb-4038-97a1-60c8bb1d42b9 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-a0ac33a3-a8bb-4038-97a1-60c8bb1d42b9');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                                      ID  ...  InteractionTime\n",
              "Unnamed: 0                                ...                 \n",
              "1           AMsySZbNg8SBwPtj7IGHnip_8aY0  ...         0.171601\n",
              "2           AMsySZZcUFNGOJs-lfC9j-ZDlV7Z  ...         4.303945\n",
              "3           AMsySZYoK8_bD0hGv4zu0iRn1TFo  ...         0.868106\n",
              "4           AMsySZahxpwLOWnMJj6RGATgwEOc  ...         0.802647\n",
              "5           AMsySZbqgfMBDtAqZz1jVRaOmX00  ...         0.627148\n",
              "\n",
              "[5 rows x 8 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 4
        }
      ],
      "source": [
        "## read data from ctrdata.csv\n",
        "Origin = pd.read_csv('/content/drive/My Drive/website project/test3_data.csv')\n",
        "Origin = Origin.set_index('Unnamed: 0')\n",
        "Origin.head()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# EDA & FEATURE ENGINEERING"
      ],
      "metadata": {
        "id": "aUE233yLk4ZG"
      },
      "id": "aUE233yLk4ZG"
    },
    {
      "cell_type": "code",
      "source": [
        "## Convert outcomes to 1 or 0 \n",
        "Origin['Action'] = Origin['Action'].replace({'View':0,'Click':1})\n",
        "Origin.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 319
        },
        "id": "dmrzM9wOSJQO",
        "outputId": "b746c83d-68b8-48d8-bf0f-d25e3287d402"
      },
      "id": "dmrzM9wOSJQO",
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-c506897c-34d0-45cf-9d7b-0135a6e64008\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>ActionTime</th>\n",
              "      <th>Action</th>\n",
              "      <th>Website</th>\n",
              "      <th>BannerSize</th>\n",
              "      <th>Brand</th>\n",
              "      <th>colour</th>\n",
              "      <th>InteractionTime</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Unnamed: 0</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>AMsySZbNg8SBwPtj7IGHnip_8aY0</td>\n",
              "      <td>1508761859495365</td>\n",
              "      <td>0</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x600</td>\n",
              "      <td>Carter's</td>\n",
              "      <td>Pink</td>\n",
              "      <td>0.171601</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>AMsySZZcUFNGOJs-lfC9j-ZDlV7Z</td>\n",
              "      <td>1502847469736117</td>\n",
              "      <td>0</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Burberry</td>\n",
              "      <td>Red</td>\n",
              "      <td>4.303945</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>AMsySZYoK8_bD0hGv4zu0iRn1TFo</td>\n",
              "      <td>1514169431528120</td>\n",
              "      <td>0</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>728x90</td>\n",
              "      <td>Disney</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>0.868106</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>AMsySZahxpwLOWnMJj6RGATgwEOc</td>\n",
              "      <td>1515527952591896</td>\n",
              "      <td>0</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>320x50</td>\n",
              "      <td>Carter's</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>0.802647</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>AMsySZbqgfMBDtAqZz1jVRaOmX00</td>\n",
              "      <td>1507514809374045</td>\n",
              "      <td>0</td>\n",
              "      <td>instagram.com</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Gap</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.627148</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c506897c-34d0-45cf-9d7b-0135a6e64008')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-c506897c-34d0-45cf-9d7b-0135a6e64008 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-c506897c-34d0-45cf-9d7b-0135a6e64008');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                                      ID  ...  InteractionTime\n",
              "Unnamed: 0                                ...                 \n",
              "1           AMsySZbNg8SBwPtj7IGHnip_8aY0  ...         0.171601\n",
              "2           AMsySZZcUFNGOJs-lfC9j-ZDlV7Z  ...         4.303945\n",
              "3           AMsySZYoK8_bD0hGv4zu0iRn1TFo  ...         0.868106\n",
              "4           AMsySZahxpwLOWnMJj6RGATgwEOc  ...         0.802647\n",
              "5           AMsySZbqgfMBDtAqZz1jVRaOmX00  ...         0.627148\n",
              "\n",
              "[5 rows x 8 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Detemine output, split testdata\n",
        "from sklearn.model_selection import train_test_split\n",
        "X = Origin.drop(columns=['Action'])\n",
        "y = Origin['Action']\n",
        "\n",
        "adX_train, adX_test, ady_train, ady_test = train_test_split(X, y, test_size=0.25)\n",
        "adX_train.info()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "JXT6JsEoolZw",
        "outputId": "75428653-16d1-4129-8b29-8bf6f8356c6e"
      },
      "id": "JXT6JsEoolZw",
      "execution_count": 7,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "Int64Index: 750000 entries, 383904 to 876544\n",
            "Data columns (total 7 columns):\n",
            " #   Column           Non-Null Count   Dtype  \n",
            "---  ------           --------------   -----  \n",
            " 0   ID               750000 non-null  object \n",
            " 1   ActionTime       750000 non-null  int64  \n",
            " 2   Website          750000 non-null  object \n",
            " 3   BannerSize       750000 non-null  object \n",
            " 4   Brand            750000 non-null  object \n",
            " 5   colour           750000 non-null  object \n",
            " 6   InteractionTime  749993 non-null  float64\n",
            "dtypes: float64(1), int64(1), object(5)\n",
            "memory usage: 45.8+ MB\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "ady_train.value_counts(normalize=True)\n",
        "## highly imbalance dataset"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "9YukdYLgnGkJ",
        "outputId": "548c7007-8b4c-429f-9f5b-a807f0b067bb"
      },
      "id": "9YukdYLgnGkJ",
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "0    0.999743\n",
              "1    0.000257\n",
              "Name: Action, dtype: float64"
            ]
          },
          "metadata": {},
          "execution_count": 8
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Filling missing values\n",
        "ITmean = adX_train['InteractionTime'].mean() \n",
        "adX_train['InteractionTime'] = adX_train['InteractionTime'].fillna(ITmean)"
      ],
      "metadata": {
        "id": "jkN5A8wrobXG"
      },
      "id": "jkN5A8wrobXG",
      "execution_count": 9,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "## Datetime exploration\n",
        "adX_train['ActionTime']\n",
        "## the feature need to be converted to datime format"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "_K1PX6XvNo3X",
        "outputId": "1dd67e45-014d-4651-f919-63e8f8792c09"
      },
      "id": "_K1PX6XvNo3X",
      "execution_count": 7,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Unnamed: 0\n",
              "536065    1504673354040192\n",
              "282820    1506437893766555\n",
              "45397     1503409685398404\n",
              "374382    1503198548260201\n",
              "989433    1512847936937828\n",
              "                ...       \n",
              "568       1506950369034910\n",
              "274453    1506866024865137\n",
              "392461    1506381092838440\n",
              "651599    1507258104659921\n",
              "249873    1504256742060914\n",
              "Name: ActionTime, Length: 750000, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 7
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Datetime Engineering\n",
        "## Convert ActionTime to regular timestamp\n",
        "adX_train['ActionTime']=pd.to_datetime(adX_train['ActionTime'].astype('float64')/10**6, unit='s')"
      ],
      "metadata": {
        "id": "oTlk2N5qWM1Z"
      },
      "id": "oTlk2N5qWM1Z",
      "execution_count": 10,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "## Classify the ActionTime timestamp to different seasons of a year\n",
        "adX_train['month'] = pd.to_datetime(adX_train ['ActionTime']).dt.month\n",
        "season = [-1, 3.1, 6.1, 9.1, 12.1]\n",
        "## If the view action happen at 2:00 am, it is classified as late_night\n",
        "season_name = ['Spring', 'Summer', 'Fall', 'Winter']\n",
        "adX_train['Season'] = pd.cut(adX_train['month'], bins=season, labels=season_name)\n",
        "\n",
        "## Classify the ActionTime timestamp to different periods of a day\n",
        "adX_train['hr'] = pd.to_datetime(adX_train ['ActionTime']).dt.hour\n",
        "time = [-1, 2.1, 6.1, 9.1, 11.1, 19.1, 24]\n",
        "## If the view action happen at 2:00 am, it is classified as late_night\n",
        "time_name = ['late_night', 'early_morning', 'morning', 'noon', 'afternoon', 'evening']\n",
        "adX_train['Daysection'] = pd.cut(adX_train['hr'], bins=time, labels=time_name)\n",
        "\n",
        "\n",
        "## Classify the ActionTime timestamp to either a weekday or weekend\n",
        "def wd(a):\n",
        "    if a==5 or a==6:\n",
        "        b='weekend'\n",
        "    else:\n",
        "        b='weekday'\n",
        "    return b\n",
        "\n",
        "adX_train['Dayofweek'] = pd.to_datetime(adX_train ['ActionTime']).dt.dayofweek.apply(wd)\n",
        "\n"
      ],
      "metadata": {
        "id": "V7kzB69AN2gi"
      },
      "id": "V7kzB69AN2gi",
      "execution_count": 11,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "adX_train"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 710
        },
        "id": "KYfRfghXVmM8",
        "outputId": "7d67885d-7f90-48b9-ec80-dd68e0bca4cc"
      },
      "id": "KYfRfghXVmM8",
      "execution_count": 40,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-44106ee9-62a9-463f-947c-20d664159e06\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>ActionTime</th>\n",
              "      <th>Website</th>\n",
              "      <th>BannerSize</th>\n",
              "      <th>Brand</th>\n",
              "      <th>colour</th>\n",
              "      <th>InteractionTime</th>\n",
              "      <th>month</th>\n",
              "      <th>Season</th>\n",
              "      <th>hr</th>\n",
              "      <th>Daysection</th>\n",
              "      <th>Dayofweek</th>\n",
              "      <th>ID_time_colour_mean</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Unnamed: 0</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>536065</th>\n",
              "      <td>AMsySZb0WxJUKk3m9Fz3XlNUWtUv</td>\n",
              "      <td>2017-09-06 04:49:14.040192000</td>\n",
              "      <td>Craigslist.ca</td>\n",
              "      <td>728x90</td>\n",
              "      <td>Carter's</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>2.486531</td>\n",
              "      <td>9</td>\n",
              "      <td>Fall</td>\n",
              "      <td>4</td>\n",
              "      <td>early_morning</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.962091</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>282820</th>\n",
              "      <td>AMsySZYlhAzTnFKPYSIJTF7femGt</td>\n",
              "      <td>2017-09-26 14:58:13.766555136</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Burberry</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.056843</td>\n",
              "      <td>9</td>\n",
              "      <td>Fall</td>\n",
              "      <td>14</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.219846</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>45397</th>\n",
              "      <td>AMsySZZRoIX607CAIkA_hrTtI3ZG</td>\n",
              "      <td>2017-08-22 13:48:05.398403840</td>\n",
              "      <td>instagram.com</td>\n",
              "      <td>Other</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>1.086219</td>\n",
              "      <td>8</td>\n",
              "      <td>Fall</td>\n",
              "      <td>13</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekday</td>\n",
              "      <td>1.032731</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>374382</th>\n",
              "      <td>AMsySZbZE9bWUuWq0bPfSdFBVGr-</td>\n",
              "      <td>2017-08-20 03:09:08.260200960</td>\n",
              "      <td>Other</td>\n",
              "      <td>Other</td>\n",
              "      <td>Burberry</td>\n",
              "      <td>Pink</td>\n",
              "      <td>0.018780</td>\n",
              "      <td>8</td>\n",
              "      <td>Fall</td>\n",
              "      <td>3</td>\n",
              "      <td>early_morning</td>\n",
              "      <td>weekend</td>\n",
              "      <td>1.869024</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>989433</th>\n",
              "      <td>AMsySZaT9pK_QyDg9Z5pRCDqfNVq</td>\n",
              "      <td>2017-12-09 19:32:16.937828096</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>JoeFresh</td>\n",
              "      <td>Pink</td>\n",
              "      <td>1.724722</td>\n",
              "      <td>12</td>\n",
              "      <td>Winter</td>\n",
              "      <td>19</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekend</td>\n",
              "      <td>1.724722</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>568</th>\n",
              "      <td>AMsySZZEt4gspFnljk9bHi92bzUI</td>\n",
              "      <td>2017-10-02 13:19:29.034909952</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>1.144277</td>\n",
              "      <td>10</td>\n",
              "      <td>Winter</td>\n",
              "      <td>13</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.795353</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>274453</th>\n",
              "      <td>AMsySZbNK8l5-WJEZEBQ6OLYAGhr</td>\n",
              "      <td>2017-10-01 13:53:44.865137152</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>728x90</td>\n",
              "      <td>Carter's</td>\n",
              "      <td>Pink</td>\n",
              "      <td>1.248374</td>\n",
              "      <td>10</td>\n",
              "      <td>Winter</td>\n",
              "      <td>13</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekend</td>\n",
              "      <td>1.475222</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>392461</th>\n",
              "      <td>AMsySZZ_9kuWhXdAMHrBoQBMyW_a</td>\n",
              "      <td>2017-09-25 23:11:32.838439936</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Zara</td>\n",
              "      <td>Blue</td>\n",
              "      <td>0.675927</td>\n",
              "      <td>9</td>\n",
              "      <td>Fall</td>\n",
              "      <td>23</td>\n",
              "      <td>evening</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.457400</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>651599</th>\n",
              "      <td>AMsySZYx3LY_x1sJW6opIrJCLBxd</td>\n",
              "      <td>2017-10-06 02:48:24.659920896</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>gymboree</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.033221</td>\n",
              "      <td>10</td>\n",
              "      <td>Winter</td>\n",
              "      <td>2</td>\n",
              "      <td>late_night</td>\n",
              "      <td>weekday</td>\n",
              "      <td>1.049492</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>249873</th>\n",
              "      <td>AMsySZaZT22tPShKAWwgJQSLv9Kj</td>\n",
              "      <td>2017-09-01 09:05:42.060913920</td>\n",
              "      <td>TubeMogul</td>\n",
              "      <td>Other</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Blue</td>\n",
              "      <td>0.262196</td>\n",
              "      <td>9</td>\n",
              "      <td>Fall</td>\n",
              "      <td>9</td>\n",
              "      <td>morning</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.262196</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>750000 rows × 13 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-44106ee9-62a9-463f-947c-20d664159e06')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-44106ee9-62a9-463f-947c-20d664159e06 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-44106ee9-62a9-463f-947c-20d664159e06');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                                      ID  ... ID_time_colour_mean\n",
              "Unnamed: 0                                ...                    \n",
              "536065      AMsySZb0WxJUKk3m9Fz3XlNUWtUv  ...            0.962091\n",
              "282820      AMsySZYlhAzTnFKPYSIJTF7femGt  ...            0.219846\n",
              "45397       AMsySZZRoIX607CAIkA_hrTtI3ZG  ...            1.032731\n",
              "374382      AMsySZbZE9bWUuWq0bPfSdFBVGr-  ...            1.869024\n",
              "989433      AMsySZaT9pK_QyDg9Z5pRCDqfNVq  ...            1.724722\n",
              "...                                  ...  ...                 ...\n",
              "568         AMsySZZEt4gspFnljk9bHi92bzUI  ...            0.795353\n",
              "274453      AMsySZbNK8l5-WJEZEBQ6OLYAGhr  ...            1.475222\n",
              "392461      AMsySZZ_9kuWhXdAMHrBoQBMyW_a  ...            0.457400\n",
              "651599      AMsySZYx3LY_x1sJW6opIrJCLBxd  ...            1.049492\n",
              "249873      AMsySZaZT22tPShKAWwgJQSLv9Kj  ...            0.262196\n",
              "\n",
              "[750000 rows x 13 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 40
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# rate function\n",
        "def rate_calculation(x):\n",
        "    \"\"\"Calculate the attributed rate. Scale by confidence\"\"\"\n",
        "    rate = x.sum() / float(x.count())\n",
        "    conf = np.min([1, np.log10(x.count()) / log_group])\n",
        "    return rate * conf\n",
        "\n",
        "# prob function\n",
        "def prob_calculation(x):\n",
        "    \"\"\"Calculate the attributed rate. Scale by confidence\"\"\"\n",
        "    prob = x.count() / (x.count().sum())\n",
        "    return prob\n"
      ],
      "metadata": {
        "id": "6YF5j1RJQ51s"
      },
      "id": "6YF5j1RJQ51s",
      "execution_count": 41,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "X_train = adX_train.copy()[['ID', 'InteractionTime', 'Website', 'Season', 'BannerSize', 'Brand', 'colour', 'Dayofweek', 'Daysection']]\n",
        "\n",
        "ATTRIBUTION_CATEGORIES = [        \n",
        "    # V1 Features #\n",
        "    ###############\n",
        "    ['ID'], ['Website'], ['Season'], ['BannerSize'], ['Brand'], ['colour'], ['Dayofweek'], ['Daysection'],\n",
        "    \n",
        "    # V2 Features #\n",
        "    ###############\n",
        "    ['ID', 'Website'],\n",
        "    ['ID', 'Brand'],\n",
        "    ['ID', 'Dayofweek'],\n",
        "    ['ID', 'colour'],\n",
        "    ['ID', 'BannerSize'],\n",
        "    ['ID', 'Daysection'],\n",
        "    \n",
        "    # V3 Features #\n",
        "    ###############\n",
        "    ['Website', 'Brand'],\n",
        "    ['Website', 'Dayofweek'],\n",
        "    ['Website', 'Season']\n",
        "]\n",
        "\n",
        "\n",
        "# Find frequency of is_attributed for each unique value in column\n",
        "freqs = {}\n",
        "for cols in ATTRIBUTION_CATEGORIES:\n",
        "    \n",
        "    # New feature name\n",
        "    new_feature = '_'.join(cols)+'_confRate'    \n",
        "    \n",
        "    # Perform the groupby\n",
        "    group_object = X_train.groupby(cols)\n",
        "    \n",
        "    # Group sizes    \n",
        "    group_sizes = group_object.size()\n",
        "    log_group = np.log10(10000) # 100 views -> 50% confidence, 10 views -> 25% confidence \n",
        "    print(\">> Calculating confidence-weighted rate for: {}.\\n   Saving to: {}. Group Max /Mean / Median / Min: {} / {} / {} / {}\".format(\n",
        "        cols, new_feature, \n",
        "        group_sizes.max(), \n",
        "        np.round(group_sizes.mean(), 2),\n",
        "        np.round(group_sizes.median(), 2),\n",
        "        group_sizes.min()\n",
        "    ))\n",
        "    \n",
        "    # Perform the merge\n",
        "    X_train = X_train.merge(\n",
        "        group_object['InteractionTime']. \\\n",
        "            apply(rate_calculation). \\\n",
        "            reset_index(). \\\n",
        "            rename( \n",
        "                index=str,\n",
        "                columns={'InteractionTime': new_feature}\n",
        "            )[cols + [new_feature]],\n",
        "        on=cols, how='left'\n",
        "    )\n",
        "    \n",
        "    # New feature name2\n",
        "    new_feature2 = '_'.join(cols)+'_prob'\n",
        "\n",
        "    # Perform the groupby\n",
        "    group_object = X_train.groupby(cols)\n",
        "\n",
        "    # Perform the merge\n",
        "    X_train = X_train.merge(\n",
        "        group_object['InteractionTime']. \\\n",
        "            apply(prob_calculation). \\\n",
        "            reset_index(). \\\n",
        "            rename( \n",
        "                index=str,\n",
        "                columns={'InteractionTime': new_feature2}\n",
        "            )[cols + [new_feature2]],\n",
        "        on=cols, how='left'\n",
        "    )\n",
        "\n",
        "X_train.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "4wnHDUkMGIOA",
        "outputId": "6aac41bf-8093-449d-d954-b7b873dc1337"
      },
      "id": "4wnHDUkMGIOA",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ">> Calculating confidence-weighted rate for: ['ID'].\n",
            "   Saving to: ID_confRate. Group Max /Mean / Median / Min: 1690 / 3.94 / 2.0 / 1\n",
            ">> Calculating confidence-weighted rate for: ['Website'].\n",
            "   Saving to: Website_confRate. Group Max /Mean / Median / Min: 449475 / 46875.0 / 15603.5 / 422\n",
            ">> Calculating confidence-weighted rate for: ['Season'].\n",
            "   Saving to: Season_confRate. Group Max /Mean / Median / Min: 347215 / 187500.0 / 201392.5 / 0\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:4: RuntimeWarning: invalid value encountered in double_scalars\n",
            "  after removing the cwd from sys.path.\n",
            "/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:5: RuntimeWarning: divide by zero encountered in log10\n",
            "  \"\"\"\n",
            "/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: RuntimeWarning: invalid value encountered in long_scalars\n",
            "  # This is added back by InteractiveShellApp.init_path()\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            ">> Calculating confidence-weighted rate for: ['BannerSize'].\n",
            "   Saving to: BannerSize_confRate. Group Max /Mean / Median / Min: 306158 / 50000.0 / 6532.0 / 66\n",
            ">> Calculating confidence-weighted rate for: ['Brand'].\n",
            "   Saving to: Brand_confRate. Group Max /Mean / Median / Min: 167082 / 75000.0 / 62751.5 / 20939\n",
            ">> Calculating confidence-weighted rate for: ['colour'].\n",
            "   Saving to: colour_confRate. Group Max /Mean / Median / Min: 242006 / 107142.86 / 103466.0 / 34501\n",
            ">> Calculating confidence-weighted rate for: ['Dayofweek'].\n",
            "   Saving to: Dayofweek_confRate. Group Max /Mean / Median / Min: 551061 / 375000.0 / 375000.0 / 198939\n",
            ">> Calculating confidence-weighted rate for: ['Daysection'].\n",
            "   Saving to: Daysection_confRate. Group Max /Mean / Median / Min: 289126 / 125000.0 / 113950.0 / 33728\n",
            ">> Calculating confidence-weighted rate for: ['ID', 'Website'].\n",
            "   Saving to: ID_Website_confRate. Group Max /Mean / Median / Min: 1672 / 3.09 / 1.0 / 1\n",
            ">> Calculating confidence-weighted rate for: ['ID', 'Brand'].\n",
            "   Saving to: ID_Brand_confRate. Group Max /Mean / Median / Min: 369 / 1.73 / 1.0 / 1\n",
            ">> Calculating confidence-weighted rate for: ['ID', 'Dayofweek'].\n",
            "   Saving to: ID_Dayofweek_confRate. Group Max /Mean / Median / Min: 1340 / 3.23 / 1.0 / 1\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "(adX_train.groupby(['ID','colour'])['InteractionTime'].count().sum())"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "9XnDkBsDOUVF",
        "outputId": "862c94cb-57bf-4fe9-e2dc-b753024211af"
      },
      "id": "9XnDkBsDOUVF",
      "execution_count": 42,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "750000"
            ]
          },
          "metadata": {},
          "execution_count": 42
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Feature ID examination \n",
        "adX_train['ID'].value_counts().describe()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "xBRi09d7nXcf",
        "outputId": "56f73f41-5f6a-4825-942d-0f25cd10fccf"
      },
      "id": "xBRi09d7nXcf",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "count    190489.000000\n",
              "mean          3.937235\n",
              "std          12.372357\n",
              "min           1.000000\n",
              "25%           1.000000\n",
              "50%           2.000000\n",
              "75%           3.000000\n",
              "max        1677.000000\n",
              "Name: ID, dtype: float64"
            ]
          },
          "metadata": {},
          "execution_count": 14
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Feature ID examination \n",
        "data = adX_train['ID'].value_counts()\n",
        "# Boxplot the count of IDs\n",
        "fig = plt.figure()\n",
        "fig.suptitle('IDs on Record', fontsize=14, fontweight='bold')\n",
        "\n",
        "ax = fig.add_subplot(111)\n",
        "ax.boxplot(data)\n",
        "\n",
        "ax.set_xlabel('IDs')\n",
        "ax.set_ylabel('Frequency')\n",
        "\n",
        "plt.show(); \n",
        "## Base on the ID analysis, the times of ad viewing by different users range from 1 to almost 1750 times"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 308
        },
        "id": "5sWair2RlQSn",
        "outputId": "0721a7eb-eb1b-485d-d625-30b0352424a8"
      },
      "id": "5sWair2RlQSn",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Feature ID Engineering: convert ID to frequency of interactions based on the number of ID on record\n",
        "id_freq = adX_train['ID'].value_counts(normalize=True).to_dict()\n",
        "adX_train['ID_freq'] = adX_train['ID'].map(id_freq)\n",
        "adX_train[['ID','ID_freq']]\n",
        "\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 455
        },
        "id": "Qg-hFaUDuFqv",
        "outputId": "f3745de6-ecaa-4d73-c21f-80279c566e95"
      },
      "id": "Qg-hFaUDuFqv",
      "execution_count": 14,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-344ec870-fea3-4e0a-93b7-2ac45c26bf63\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>ID_freq</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Unnamed: 0</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>736981</th>\n",
              "      <td>AMsySZYnJECfUM7tLw8u64FutDdA</td>\n",
              "      <td>0.000189</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>270114</th>\n",
              "      <td>AMsySZbX4oDzXfQhGggsGrX7Wk7-</td>\n",
              "      <td>0.000003</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>518858</th>\n",
              "      <td>AMsySZZCY8G_Ic82DqWCxChN1zVc</td>\n",
              "      <td>0.000016</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>877975</th>\n",
              "      <td>AMsySZbBRIoehcWGFjWYTl1Kw7U0</td>\n",
              "      <td>0.000024</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>758819</th>\n",
              "      <td>AMsySZawbN3UgJogMJXG5bF7QPpL</td>\n",
              "      <td>0.000408</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>480356</th>\n",
              "      <td>AMsySZYm-7gGRLNQe4zZyEj8_EeH</td>\n",
              "      <td>0.000025</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>347817</th>\n",
              "      <td>AMsySZZ-5JXsLv5MmvWDMYCTCkDn</td>\n",
              "      <td>0.000065</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>470512</th>\n",
              "      <td>AMsySZZLignVs1qoC7avDUXsY6AR</td>\n",
              "      <td>0.000017</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>296653</th>\n",
              "      <td>AMsySZZAyeuUCRbzW9ql_Scv_ed-</td>\n",
              "      <td>0.000003</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>362572</th>\n",
              "      <td>AMsySZYSeEgnATGGcIy8ldJVBgvo</td>\n",
              "      <td>0.000185</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>750000 rows × 2 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-344ec870-fea3-4e0a-93b7-2ac45c26bf63')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-344ec870-fea3-4e0a-93b7-2ac45c26bf63 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-344ec870-fea3-4e0a-93b7-2ac45c26bf63');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                                      ID   ID_freq\n",
              "Unnamed: 0                                        \n",
              "736981      AMsySZYnJECfUM7tLw8u64FutDdA  0.000189\n",
              "270114      AMsySZbX4oDzXfQhGggsGrX7Wk7-  0.000003\n",
              "518858      AMsySZZCY8G_Ic82DqWCxChN1zVc  0.000016\n",
              "877975      AMsySZbBRIoehcWGFjWYTl1Kw7U0  0.000024\n",
              "758819      AMsySZawbN3UgJogMJXG5bF7QPpL  0.000408\n",
              "...                                  ...       ...\n",
              "480356      AMsySZYm-7gGRLNQe4zZyEj8_EeH  0.000025\n",
              "347817      AMsySZZ-5JXsLv5MmvWDMYCTCkDn  0.000065\n",
              "470512      AMsySZZLignVs1qoC7avDUXsY6AR  0.000017\n",
              "296653      AMsySZZAyeuUCRbzW9ql_Scv_ed-  0.000003\n",
              "362572      AMsySZYSeEgnATGGcIy8ldJVBgvo  0.000185\n",
              "\n",
              "[750000 rows x 2 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 14
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "adX_train.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 405
        },
        "id": "Pmb8k8FWZM8k",
        "outputId": "2bcf59ec-6ead-4116-b4c9-00672abf23a1"
      },
      "id": "Pmb8k8FWZM8k",
      "execution_count": 16,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-2e1b28c2-5348-4d78-8aec-0be8655e8465\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>ActionTime</th>\n",
              "      <th>Website</th>\n",
              "      <th>BannerSize</th>\n",
              "      <th>Brand</th>\n",
              "      <th>colour</th>\n",
              "      <th>InteractionTime</th>\n",
              "      <th>month</th>\n",
              "      <th>Season</th>\n",
              "      <th>hr</th>\n",
              "      <th>Daysection</th>\n",
              "      <th>Dayofweek</th>\n",
              "      <th>ID_freq</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Unnamed: 0</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>736981</th>\n",
              "      <td>AMsySZYnJECfUM7tLw8u64FutDdA</td>\n",
              "      <td>2017-09-28 04:10:25.274920960</td>\n",
              "      <td>Craigslist.ca</td>\n",
              "      <td>320x50</td>\n",
              "      <td>JoeFresh</td>\n",
              "      <td>other</td>\n",
              "      <td>0.238740</td>\n",
              "      <td>9</td>\n",
              "      <td>Fall</td>\n",
              "      <td>4</td>\n",
              "      <td>early_morning</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.000189</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>270114</th>\n",
              "      <td>AMsySZbX4oDzXfQhGggsGrX7Wk7-</td>\n",
              "      <td>2017-08-23 12:01:55.804784896</td>\n",
              "      <td>Amazon</td>\n",
              "      <td>728x90</td>\n",
              "      <td>Carter's</td>\n",
              "      <td>Pink</td>\n",
              "      <td>1.045621</td>\n",
              "      <td>8</td>\n",
              "      <td>Fall</td>\n",
              "      <td>12</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.000003</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>518858</th>\n",
              "      <td>AMsySZZCY8G_Ic82DqWCxChN1zVc</td>\n",
              "      <td>2017-11-03 04:44:46.961070080</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>320x50</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.322246</td>\n",
              "      <td>11</td>\n",
              "      <td>Winter</td>\n",
              "      <td>4</td>\n",
              "      <td>early_morning</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.000016</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>877975</th>\n",
              "      <td>AMsySZbBRIoehcWGFjWYTl1Kw7U0</td>\n",
              "      <td>2017-09-29 23:22:17.372651008</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>300x250</td>\n",
              "      <td>Burberry</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.642260</td>\n",
              "      <td>9</td>\n",
              "      <td>Fall</td>\n",
              "      <td>23</td>\n",
              "      <td>evening</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.000024</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>758819</th>\n",
              "      <td>AMsySZawbN3UgJogMJXG5bF7QPpL</td>\n",
              "      <td>2017-08-07 16:54:48.329652992</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>160x600</td>\n",
              "      <td>Zara</td>\n",
              "      <td>Pink</td>\n",
              "      <td>0.095042</td>\n",
              "      <td>8</td>\n",
              "      <td>Fall</td>\n",
              "      <td>16</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekday</td>\n",
              "      <td>0.000408</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2e1b28c2-5348-4d78-8aec-0be8655e8465')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-2e1b28c2-5348-4d78-8aec-0be8655e8465 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-2e1b28c2-5348-4d78-8aec-0be8655e8465');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                                      ID  ...   ID_freq\n",
              "Unnamed: 0                                ...          \n",
              "736981      AMsySZYnJECfUM7tLw8u64FutDdA  ...  0.000189\n",
              "270114      AMsySZbX4oDzXfQhGggsGrX7Wk7-  ...  0.000003\n",
              "518858      AMsySZZCY8G_Ic82DqWCxChN1zVc  ...  0.000016\n",
              "877975      AMsySZbBRIoehcWGFjWYTl1Kw7U0  ...  0.000024\n",
              "758819      AMsySZawbN3UgJogMJXG5bF7QPpL  ...  0.000408\n",
              "\n",
              "[5 rows x 13 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 16
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "id_time_mean = adX_train.groupby('ID')['InteractionTime'].mean().to_dict()\n",
        "adX_train['ID_time_mean'] = adX_train['ID'].map(id_time_mean)\n",
        "adX_train[['ID','ID_time_mean']]"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 455
        },
        "id": "ZYrLgqBRYVNs",
        "outputId": "bf9f59aa-66b1-4ea4-f197-c7aa372aff35"
      },
      "id": "ZYrLgqBRYVNs",
      "execution_count": 18,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-18fbb067-124d-4c98-bd00-43719d2bb02a\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>ID_time_mean</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Unnamed: 0</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>736981</th>\n",
              "      <td>AMsySZYnJECfUM7tLw8u64FutDdA</td>\n",
              "      <td>1.090003</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>270114</th>\n",
              "      <td>AMsySZbX4oDzXfQhGggsGrX7Wk7-</td>\n",
              "      <td>0.828126</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>518858</th>\n",
              "      <td>AMsySZZCY8G_Ic82DqWCxChN1zVc</td>\n",
              "      <td>1.048596</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>877975</th>\n",
              "      <td>AMsySZbBRIoehcWGFjWYTl1Kw7U0</td>\n",
              "      <td>0.742971</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>758819</th>\n",
              "      <td>AMsySZawbN3UgJogMJXG5bF7QPpL</td>\n",
              "      <td>0.987200</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>480356</th>\n",
              "      <td>AMsySZYm-7gGRLNQe4zZyEj8_EeH</td>\n",
              "      <td>1.695090</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>347817</th>\n",
              "      <td>AMsySZZ-5JXsLv5MmvWDMYCTCkDn</td>\n",
              "      <td>1.030189</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>470512</th>\n",
              "      <td>AMsySZZLignVs1qoC7avDUXsY6AR</td>\n",
              "      <td>0.745688</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>296653</th>\n",
              "      <td>AMsySZZAyeuUCRbzW9ql_Scv_ed-</td>\n",
              "      <td>0.311904</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>362572</th>\n",
              "      <td>AMsySZYSeEgnATGGcIy8ldJVBgvo</td>\n",
              "      <td>0.883905</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>750000 rows × 2 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-18fbb067-124d-4c98-bd00-43719d2bb02a')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-18fbb067-124d-4c98-bd00-43719d2bb02a button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-18fbb067-124d-4c98-bd00-43719d2bb02a');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                                      ID  ID_time_mean\n",
              "Unnamed: 0                                            \n",
              "736981      AMsySZYnJECfUM7tLw8u64FutDdA      1.090003\n",
              "270114      AMsySZbX4oDzXfQhGggsGrX7Wk7-      0.828126\n",
              "518858      AMsySZZCY8G_Ic82DqWCxChN1zVc      1.048596\n",
              "877975      AMsySZbBRIoehcWGFjWYTl1Kw7U0      0.742971\n",
              "758819      AMsySZawbN3UgJogMJXG5bF7QPpL      0.987200\n",
              "...                                  ...           ...\n",
              "480356      AMsySZYm-7gGRLNQe4zZyEj8_EeH      1.695090\n",
              "347817      AMsySZZ-5JXsLv5MmvWDMYCTCkDn      1.030189\n",
              "470512      AMsySZZLignVs1qoC7avDUXsY6AR      0.745688\n",
              "296653      AMsySZZAyeuUCRbzW9ql_Scv_ed-      0.311904\n",
              "362572      AMsySZYSeEgnATGGcIy8ldJVBgvo      0.883905\n",
              "\n",
              "[750000 rows x 2 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 18
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "id_time_colour_mean = adX_train.groupby(['ID','colour'])['InteractionTime'].transform('mean')\n",
        "adX_train['ID_time_colour_mean'] = id_time_colour_mean\n",
        "adX_train[['ID','colour','ID_time_colour_mean']]"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 455
        },
        "id": "_k7b5IykalAU",
        "outputId": "fd01f168-27e9-41af-8486-1ef5d6dade22"
      },
      "id": "_k7b5IykalAU",
      "execution_count": 39,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-bf32256d-0f4a-4ecd-a7cd-b73726a9dc45\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>colour</th>\n",
              "      <th>ID_time_colour_mean</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Unnamed: 0</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>536065</th>\n",
              "      <td>AMsySZb0WxJUKk3m9Fz3XlNUWtUv</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>0.962091</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>282820</th>\n",
              "      <td>AMsySZYlhAzTnFKPYSIJTF7femGt</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.219846</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>45397</th>\n",
              "      <td>AMsySZZRoIX607CAIkA_hrTtI3ZG</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>1.032731</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>374382</th>\n",
              "      <td>AMsySZbZE9bWUuWq0bPfSdFBVGr-</td>\n",
              "      <td>Pink</td>\n",
              "      <td>1.869024</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>989433</th>\n",
              "      <td>AMsySZaT9pK_QyDg9Z5pRCDqfNVq</td>\n",
              "      <td>Pink</td>\n",
              "      <td>1.724722</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>568</th>\n",
              "      <td>AMsySZZEt4gspFnljk9bHi92bzUI</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>0.795353</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>274453</th>\n",
              "      <td>AMsySZbNK8l5-WJEZEBQ6OLYAGhr</td>\n",
              "      <td>Pink</td>\n",
              "      <td>1.475222</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>392461</th>\n",
              "      <td>AMsySZZ_9kuWhXdAMHrBoQBMyW_a</td>\n",
              "      <td>Blue</td>\n",
              "      <td>0.457400</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>651599</th>\n",
              "      <td>AMsySZYx3LY_x1sJW6opIrJCLBxd</td>\n",
              "      <td>Gold</td>\n",
              "      <td>1.049492</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>249873</th>\n",
              "      <td>AMsySZaZT22tPShKAWwgJQSLv9Kj</td>\n",
              "      <td>Blue</td>\n",
              "      <td>0.262196</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>750000 rows × 3 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-bf32256d-0f4a-4ecd-a7cd-b73726a9dc45')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-bf32256d-0f4a-4ecd-a7cd-b73726a9dc45 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-bf32256d-0f4a-4ecd-a7cd-b73726a9dc45');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                                      ID  colour  ID_time_colour_mean\n",
              "Unnamed: 0                                                           \n",
              "536065      AMsySZb0WxJUKk3m9Fz3XlNUWtUv  Yellow             0.962091\n",
              "282820      AMsySZYlhAzTnFKPYSIJTF7femGt    Gold             0.219846\n",
              "45397       AMsySZZRoIX607CAIkA_hrTtI3ZG  Yellow             1.032731\n",
              "374382      AMsySZbZE9bWUuWq0bPfSdFBVGr-    Pink             1.869024\n",
              "989433      AMsySZaT9pK_QyDg9Z5pRCDqfNVq    Pink             1.724722\n",
              "...                                  ...     ...                  ...\n",
              "568         AMsySZZEt4gspFnljk9bHi92bzUI  Yellow             0.795353\n",
              "274453      AMsySZbNK8l5-WJEZEBQ6OLYAGhr    Pink             1.475222\n",
              "392461      AMsySZZ_9kuWhXdAMHrBoQBMyW_a    Blue             0.457400\n",
              "651599      AMsySZYx3LY_x1sJW6opIrJCLBxd    Gold             1.049492\n",
              "249873      AMsySZaZT22tPShKAWwgJQSLv9Kj    Blue             0.262196\n",
              "\n",
              "[750000 rows x 3 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 39
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install feature_engine\n",
        "from feature_engine.encoding import WoEEncoder, RareLabelEncoder"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "EbcYLB3Ljess",
        "outputId": "64a8d083-9083-428b-b1c2-423a9deef7a0"
      },
      "id": "EbcYLB3Ljess",
      "execution_count": 14,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: feature_engine in /usr/local/lib/python3.7/dist-packages (1.2.0)\n",
            "Requirement already satisfied: pandas>=1.0.3 in /usr/local/lib/python3.7/dist-packages (from feature_engine) (1.3.5)\n",
            "Requirement already satisfied: numpy>=1.18.2 in /usr/local/lib/python3.7/dist-packages (from feature_engine) (1.21.5)\n",
            "Requirement already satisfied: statsmodels>=0.11.1 in /usr/local/lib/python3.7/dist-packages (from feature_engine) (0.13.2)\n",
            "Requirement already satisfied: scikit-learn>=0.22.2 in /usr/local/lib/python3.7/dist-packages (from feature_engine) (1.0.2)\n",
            "Requirement already satisfied: scipy>=1.4.1 in /usr/local/lib/python3.7/dist-packages (from feature_engine) (1.4.1)\n",
            "Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=1.0.3->feature_engine) (2.8.2)\n",
            "Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=1.0.3->feature_engine) (2018.9)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.7.3->pandas>=1.0.3->feature_engine) (1.15.0)\n",
            "Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.22.2->feature_engine) (3.1.0)\n",
            "Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.22.2->feature_engine) (1.1.0)\n",
            "Requirement already satisfied: patsy>=0.5.2 in /usr/local/lib/python3.7/dist-packages (from statsmodels>=0.11.1->feature_engine) (0.5.2)\n",
            "Requirement already satisfied: packaging>=21.3 in /usr/local/lib/python3.7/dist-packages (from statsmodels>=0.11.1->feature_engine) (21.3)\n",
            "Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=21.3->statsmodels>=0.11.1->feature_engine) (3.0.7)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "rare_encoder_ID = RareLabelEncoder(tol=0.0003, n_categories=2,variables=['ID'], replace_with='Others')\n",
        "X = adX_train.copy()\n",
        "X_encoded = rare_encoder_ID.fit(X)\n",
        "X_encoded['ID'].value_counts()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "vcH7gy_2kCV0",
        "outputId": "4d990dfc-5827-45bf-acf7-22083c7fc87d"
      },
      "id": "vcH7gy_2kCV0",
      "execution_count": 19,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Others                          725670\n",
              "AMsySZaSHnOuwfEjIHSMTU237tQS      1704\n",
              "AMsySZYzetqojeg0GiqNxk1-E49j      1671\n",
              "AMsySZYo44CqBz2TZpaBq_4ycVeA      1405\n",
              "AMsySZap-f-WDKrbqevE25h4Ywf7      1110\n",
              "                                 ...  \n",
              "AMsySZZW-4YbFpT37LXm4AKyAeJb       227\n",
              "AMsySZYhqYGpuGemiYuZf5BEnHPI       227\n",
              "AMsySZbYVp33K9Zfj2lFLPWu7es-       227\n",
              "AMsySZYXqTkOsYgjRDI2vXBgBQhy       227\n",
              "AMsySZaGCJAlslRFxZ4_Klin1Xiw       225\n",
              "Name: ID, Length: 61, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 19
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "rare_encoder_website = RareLabelEncoder(tol=0.05, n_categories=2,variables=['Website'], replace_with='Others')\n",
        "X = adX_train.copy()\n",
        "X_encoded = rare_encoder_website.fit_transform(X)\n",
        "X_encoded['Website'].value_counts()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "22npGbE-nAw9",
        "outputId": "ea547acd-bef0-4173-b053-9646b0b38ebc"
      },
      "id": "22npGbE-nAw9",
      "execution_count": 20,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Facebook         450189\n",
              "Others           138354\n",
              "Other             73030\n",
              "Atedra            46365\n",
              "instagram.com     42062\n",
              "Name: Website, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 20
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install category_encoders\n",
        "from category_encoders.woe import WOEEncoder as woe"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "PxDhwocpvOVx",
        "outputId": "54c94774-c480-4c05-e8e8-13d749e68070"
      },
      "id": "PxDhwocpvOVx",
      "execution_count": 36,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: category_encoders in /usr/local/lib/python3.7/dist-packages (2.3.0)\n",
            "Requirement already satisfied: patsy>=0.5.1 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (0.5.2)\n",
            "Requirement already satisfied: scipy>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.4.1)\n",
            "Requirement already satisfied: numpy>=1.14.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.21.5)\n",
            "Requirement already satisfied: statsmodels>=0.9.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (0.13.2)\n",
            "Requirement already satisfied: scikit-learn>=0.20.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.0.2)\n",
            "Requirement already satisfied: pandas>=0.21.1 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.3.5)\n",
            "Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.21.1->category_encoders) (2.8.2)\n",
            "Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.21.1->category_encoders) (2018.9)\n",
            "Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from patsy>=0.5.1->category_encoders) (1.15.0)\n",
            "Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.20.0->category_encoders) (3.1.0)\n",
            "Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.20.0->category_encoders) (1.1.0)\n",
            "Requirement already satisfied: packaging>=21.3 in /usr/local/lib/python3.7/dist-packages (from statsmodels>=0.9.0->category_encoders) (21.3)\n",
            "Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=21.3->statsmodels>=0.9.0->category_encoders) (3.0.7)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "X = adX_train.copy().drop(columns='InteractionTime')\n",
        "y = ady_train\n",
        "woe_encoder = woe(cols=['BannerSize'],regularization=0.00000000001)\n",
        "woe_encoder.fit(X,y)\n",
        "X_transformed = woe_encoder.transform(X)\n",
        "X_transformed['BannerSize']"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "IDmyqXVsnoCP",
        "outputId": "438350e9-89dc-4e57-d2a6-c46bdbead0b1"
      },
      "id": "IDmyqXVsnoCP",
      "execution_count": 38,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Unnamed: 0\n",
              "536065   -0.005302\n",
              "282820   -0.330245\n",
              "45397    -0.135839\n",
              "374382   -0.135839\n",
              "989433   -0.330245\n",
              "            ...   \n",
              "568      -0.330245\n",
              "274453   -0.005302\n",
              "392461   -0.330245\n",
              "651599   -0.330245\n",
              "249873   -0.135839\n",
              "Name: BannerSize, Length: 750000, dtype: float64"
            ]
          },
          "metadata": {},
          "execution_count": 38
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "y.shape"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "M5QiYGCQqAY1",
        "outputId": "46a2da63-5bfc-4058-e218-c23349a2a079"
      },
      "id": "M5QiYGCQqAY1",
      "execution_count": 30,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(750000,)"
            ]
          },
          "metadata": {},
          "execution_count": 30
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## BannerSize Exploration\n",
        "adX_train['BannerSize'].value_counts().index\n",
        "## Need to convert the data from string to size numbers"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "pgrdhepxXTnJ",
        "outputId": "9771f414-a183-4ff1-e8e2-7763e688a45c"
      },
      "id": "pgrdhepxXTnJ",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Index(['300x250', '728x90', 'Other', '320x50', '300x600', '160x600',\n",
              "       '1200x627', '1x1', '320x480', '300x50', '320x100', '768x1024',\n",
              "       '750x125', '1536x2048', 'other'],\n",
              "      dtype='object')"
            ]
          },
          "metadata": {},
          "execution_count": 21
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## BannerSize Engineering\n",
        "# Convert Banner Size to area sizes, set size(other) to 0\n",
        "adX_train['BannerSize'] = adX_train['BannerSize'].str.extract(r'(\\d+)x').fillna(0).astype(int) * adX_train['BannerSize'].str.extract(r'x(\\d+)').fillna(0).astype('int64')\n",
        "\n",
        "## Convert 0 value to mean size value\n",
        "Bannermean = adX_train['BannerSize'].mean()\n",
        "adX_train['BannerSize'] = adX_train['BannerSize'].replace(0,Bannermean)\n",
        "\n",
        "\n"
      ],
      "metadata": {
        "id": "bYJ6Ce0jn0Je"
      },
      "id": "bYJ6Ce0jn0Je",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "plt.title('Distribution of Banner Size')\n",
        "plt.xlabel('Size of Banners(square mm)')\n",
        "plt.ylabel('Number')\n",
        "plt.hist(adX_train['BannerSize'],range=(0,100000)); \n",
        "## The Sizes can be further classified"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 295
        },
        "id": "DfG0LwG7ZTb8",
        "outputId": "c8e5ad62-6a94-4acf-f39c-00a85d0f0963"
      },
      "id": "DfG0LwG7ZTb8",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Classify the Banner to different categories in terms of banner sizes\n",
        "data = adX_train['BannerSize']\n",
        "size = [0, 40000, 65000, 80000, 100000]\n",
        "\n",
        "## If the Banner size is 50000, this is a small size\n",
        "size_category = ['Very Small', 'Small', 'Regular', 'Large']\n",
        "adX_train['SizeLabel'] = pd.cut(data, bins=size, labels=size_category)\n",
        "adX_train['SizeLabel'].value_counts().plot(kind='bar');"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 308
        },
        "id": "zj0ETEn9gX95",
        "outputId": "cc06f37a-f1da-4e44-eff3-9a5f826f0c5b"
      },
      "id": "zj0ETEn9gX95",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Feature Examination Interaction Time\n",
        "adX_train['InteractionTime'].describe()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "5EM6DE2dkcoo",
        "outputId": "823db7c3-f25f-4f9c-9d13-c42da6d7bef5"
      },
      "id": "5EM6DE2dkcoo",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "count    750000.000000\n",
              "mean          0.999093\n",
              "std           0.998507\n",
              "min           0.000004\n",
              "25%           0.288899\n",
              "50%           0.693293\n",
              "75%           1.383275\n",
              "max          12.860560\n",
              "Name: InteractionTime, dtype: float64"
            ]
          },
          "metadata": {},
          "execution_count": 25
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Feature Examination Interaction Time\n",
        "\n",
        "plt.title('Distribution of Interaction time')\n",
        "plt.xlabel('Interaction Time (s)')\n",
        "plt.ylabel('Count')\n",
        "plt.hist(adX_train['InteractionTime'],range=(0,7));\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 295
        },
        "id": "RyMrM32YjpMI",
        "outputId": "ef3a9c1f-e230-4d21-ff1a-f223802c9421"
      },
      "id": "RyMrM32YjpMI",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## Feature Engineering Interaction Time\n",
        "## Classify the Interactin time to different time length categories\n",
        "data1 = adX_train['InteractionTime']\n",
        "itime = [0, 0.5, 1.5, 3, 15]\n",
        "\n",
        "## If the Banner size is 50000, this is a small size\n",
        "Length_category = ['Short', 'Regualr', 'Long', 'Very Long']\n",
        "adX_train['InteractionLength'] = pd.cut(data1, bins=itime, labels=Length_category)\n",
        "adX_train['InteractionLength'].value_counts().plot(kind='bar');"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 305
        },
        "id": "wnUvEKTbksmw",
        "outputId": "edee0c01-589e-47e2-bb63-dfe06431138d"
      },
      "id": "wnUvEKTbksmw",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "adX_train['Website'].value_counts()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "llqnBAxQjBQ5",
        "outputId": "52345ba8-472e-4f93-fc75-e59b8c1de80e"
      },
      "id": "llqnBAxQjBQ5",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Facebook         450283\n",
              "Other             73038\n",
              "Atedra            46344\n",
              "instagram.com     42101\n",
              "Craigslist.ca     29615\n",
              "Yahoo             25370\n",
              "TubeMogul         21494\n",
              "Twitter           15713\n",
              "Amazon            15430\n",
              "Sympatico          8447\n",
              "Kijiji             5754\n",
              "Expedia            5277\n",
              "Youtube            3863\n",
              "Weather            3805\n",
              "Wayfair            3039\n",
              "AOL                 427\n",
              "Name: Website, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 28
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "adX_train['Brand'].value_counts()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "avI3lD2ajTeN",
        "outputId": "b074beb4-5bb4-4452-8743-a875aa8f7ea8"
      },
      "id": "avI3lD2ajTeN",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Carter's                166666\n",
              "JoeFresh                144034\n",
              "Old Navy                112890\n",
              "Banana Republic          63015\n",
              "Burberry                 62608\n",
              "Disney                   62408\n",
              "gymboree                 52467\n",
              "Zara                     41942\n",
              "Gap                      23064\n",
              "The Children's Place     20906\n",
              "Name: Brand, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 29
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "adX_train.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 357
        },
        "id": "QAiqxCus9KsJ",
        "outputId": "295117ae-6d3c-4652-9b68-b2abf339d9e3"
      },
      "id": "QAiqxCus9KsJ",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-a22be799-7667-40f6-8438-da2e4243220f\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>ActionTime</th>\n",
              "      <th>Website</th>\n",
              "      <th>BannerSize</th>\n",
              "      <th>Brand</th>\n",
              "      <th>colour</th>\n",
              "      <th>InteractionTime</th>\n",
              "      <th>InteractiveDegree</th>\n",
              "      <th>Daysection</th>\n",
              "      <th>Dayofweek</th>\n",
              "      <th>SizeLabel</th>\n",
              "      <th>InteractionLength</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>AMsySZa3h6oWZ3ZHQom-szdoYhJ3</td>\n",
              "      <td>2017-10-17 15:28:40.093007104</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>75000.0</td>\n",
              "      <td>gymboree</td>\n",
              "      <td>Gold</td>\n",
              "      <td>0.723993</td>\n",
              "      <td>Active</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekday</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Regualr</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>AMsySZYmsjupeJ3Sr_FDR4YmKauE</td>\n",
              "      <td>2017-08-29 22:09:04.275188992</td>\n",
              "      <td>Amazon</td>\n",
              "      <td>75000.0</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Pink</td>\n",
              "      <td>0.410537</td>\n",
              "      <td>Highly Active</td>\n",
              "      <td>evening</td>\n",
              "      <td>weekday</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Short</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>AMsySZYXJdXSv8dqWvO-pA_dbJeQ</td>\n",
              "      <td>2018-01-29 23:15:07.158716928</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>75000.0</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>2.938682</td>\n",
              "      <td>Frequent</td>\n",
              "      <td>evening</td>\n",
              "      <td>weekday</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Long</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>AMsySZYDPH82vOAmLCSWTXnClb0e</td>\n",
              "      <td>2017-09-30 16:16:10.403394048</td>\n",
              "      <td>instagram.com</td>\n",
              "      <td>75000.0</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Pink</td>\n",
              "      <td>0.095405</td>\n",
              "      <td>Highly Active</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekend</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Short</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>AMsySZYWdKscM46UXk6FXnimXTMd</td>\n",
              "      <td>2018-01-10 05:43:06.501844992</td>\n",
              "      <td>Facebook</td>\n",
              "      <td>65520.0</td>\n",
              "      <td>Banana Republic</td>\n",
              "      <td>Pink</td>\n",
              "      <td>0.863773</td>\n",
              "      <td>Highly Active</td>\n",
              "      <td>early_morning</td>\n",
              "      <td>weekday</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Regualr</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a22be799-7667-40f6-8438-da2e4243220f')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-a22be799-7667-40f6-8438-da2e4243220f button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-a22be799-7667-40f6-8438-da2e4243220f');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "                             ID  ... InteractionLength\n",
              "0  AMsySZa3h6oWZ3ZHQom-szdoYhJ3  ...           Regualr\n",
              "1  AMsySZYmsjupeJ3Sr_FDR4YmKauE  ...             Short\n",
              "2  AMsySZYXJdXSv8dqWvO-pA_dbJeQ  ...              Long\n",
              "3  AMsySZYDPH82vOAmLCSWTXnClb0e  ...             Short\n",
              "4  AMsySZYWdKscM46UXk6FXnimXTMd  ...           Regualr\n",
              "\n",
              "[5 rows x 12 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 45
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "X_input = adX_train[['Website', 'BannerSize', 'Brand', 'colour',\n",
        "       'InteractionTime','InteractiveDegree', 'Daysection', 'Dayofweek']]\n",
        "\n",
        "y_input = ady_train\n",
        "y_test = ady_test"
      ],
      "metadata": {
        "id": "UCOVaFH6jhxg"
      },
      "id": "UCOVaFH6jhxg",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "X_input.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 267
        },
        "id": "tqCLl7F1cKfp",
        "outputId": "609aec89-449d-4c46-973d-08f281386a41"
      },
      "id": "tqCLl7F1cKfp",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "\n",
              "  <div id=\"df-ab150931-2363-4359-b0f1-275f30403755\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>Website</th>\n",
              "      <th>SizeLabel</th>\n",
              "      <th>Brand</th>\n",
              "      <th>colour</th>\n",
              "      <th>InteractionLength</th>\n",
              "      <th>InteractiveDegree</th>\n",
              "      <th>Daysection</th>\n",
              "      <th>Dayofweek</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>Facebook</td>\n",
              "      <td>Regular</td>\n",
              "      <td>gymboree</td>\n",
              "      <td>Gold</td>\n",
              "      <td>Regualr</td>\n",
              "      <td>Active</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekday</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>Amazon</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Pink</td>\n",
              "      <td>Short</td>\n",
              "      <td>Highly Active</td>\n",
              "      <td>evening</td>\n",
              "      <td>weekday</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>Facebook</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Yellow</td>\n",
              "      <td>Long</td>\n",
              "      <td>Frequent</td>\n",
              "      <td>evening</td>\n",
              "      <td>weekday</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>instagram.com</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Old Navy</td>\n",
              "      <td>Pink</td>\n",
              "      <td>Short</td>\n",
              "      <td>Highly Active</td>\n",
              "      <td>afternoon</td>\n",
              "      <td>weekend</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>Facebook</td>\n",
              "      <td>Regular</td>\n",
              "      <td>Banana Republic</td>\n",
              "      <td>Pink</td>\n",
              "      <td>Regualr</td>\n",
              "      <td>Highly Active</td>\n",
              "      <td>early_morning</td>\n",
              "      <td>weekday</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ab150931-2363-4359-b0f1-275f30403755')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-ab150931-2363-4359-b0f1-275f30403755 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-ab150931-2363-4359-b0f1-275f30403755');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ],
            "text/plain": [
              "         Website SizeLabel  ...     Daysection Dayofweek\n",
              "0       Facebook   Regular  ...      afternoon   weekday\n",
              "1         Amazon   Regular  ...        evening   weekday\n",
              "2       Facebook   Regular  ...        evening   weekday\n",
              "3  instagram.com   Regular  ...      afternoon   weekend\n",
              "4       Facebook   Regular  ...  early_morning   weekday\n",
              "\n",
              "[5 rows x 8 columns]"
            ]
          },
          "metadata": {},
          "execution_count": 31
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "def FeatureEngineering(X):\n",
        "    ## fill missing values\n",
        "    ITmean = X['InteractionTime'].mean() \n",
        "    X['InteractionTime'] = X['InteractionTime'].fillna(ITmean)\n",
        "\n",
        "    ## Feature ID Engineering: convert ID to degree of interactions based on the number of ID on record\n",
        "    data = X['ID'].value_counts()\n",
        "    ## Assign ranges to the frequency of ID\n",
        "\n",
        "    Number_IDs = [0, 1.5, 3.5, 5.5, 10, 1750]\n",
        "\n",
        "    ## Determine the degree of website interaction; e.g. if a user's ID appears 1000 times a day, she is determined\n",
        "    ## as a highly active online user\n",
        "\n",
        "    degree = ['Occationally Use', 'Normal', 'Frequent', 'Active', 'Highly Active']\n",
        "    X = X.set_index('ID')\n",
        "    X['InteractiveDegree'] = pd.cut(data, bins=Number_IDs, labels=degree)\n",
        "    X = X.reset_index()\n",
        "\n",
        "    ## Datetime Engineering\n",
        "    ## Convert ActionTime to regular timestamp\n",
        "    X['ActionTime']=pd.to_datetime(X['ActionTime'].astype('float64')/10**6, unit='s')\n",
        "\n",
        "    ## Classify the ActionTime timestamp to different periods of a day\n",
        "    hr = pd.to_datetime(X['ActionTime']).dt.hour\n",
        "    time = [-1, 2.1, 6.1, 9.1, 11.1, 19.1, 24]\n",
        "\n",
        "    ## If the view action happen at 2:00 am, it is classified as late_night\n",
        "    time_name = ['late_night', 'early_morning', 'morning', 'noon', 'afternoon', 'evening']\n",
        "    X['Daysection'] = pd.cut(hr, bins=time, labels=time_name)\n",
        "\n",
        "\n",
        "    ## Classify the ActionTime timestamp to either a weekday or weekend\n",
        "    def wd(a):\n",
        "        if a==5 or a==6:\n",
        "            b='weekend'\n",
        "        else:\n",
        "            b='weekday'\n",
        "        return b\n",
        "\n",
        "    X['Dayofweek'] = pd.to_datetime(X['ActionTime']).dt.dayofweek.apply(wd)\n",
        "\n",
        "    ## BannerSize Engineering\n",
        "    # Convert Banner Size to area sizes, set size(other) to 0\n",
        "    X['BannerSize'] = X['BannerSize'].str.extract(r'(\\d+)x').fillna(0).astype(int) * X['BannerSize'].str.extract(r'x(\\d+)').fillna(0).astype('int64')\n",
        "\n",
        "    ## Convert 0 value to mean size value\n",
        "    Bannermean = X['BannerSize'].mean()\n",
        "    X['BannerSize'] = X['BannerSize'].replace(0,Bannermean)\n",
        "\n",
        "    ## Classify the Banner to different categories in terms of banner sizes\n",
        "    data = X['BannerSize']\n",
        "    size = [0, 40000, 65000, 80000, 100000]\n",
        "\n",
        "    ## If the Banner size is 50000, this is a small size\n",
        "    size_category = ['Very Small', 'Small', 'Regular', 'Large']\n",
        "    X['SizeLabel'] = pd.cut(data, bins=size, labels=size_category)\n",
        "\n",
        "    ## Feature Engineering Interaction Time\n",
        "    ## Classify the Interactin time to different time length categories\n",
        "    data1 = X['InteractionTime']\n",
        "    itime = [0, 0.5, 1.5, 3, 15]\n",
        "\n",
        "    ## If the Banner size is 50000, this is a small size\n",
        "    Length_category = ['Short', 'Regualr', 'Long', 'Very Long']\n",
        "    X['InteractionLength'] = pd.cut(data1, bins=itime, labels=Length_category)\n",
        "    X = X[['Website', 'BannerSize', 'Brand', 'colour',\n",
        "       'InteractionTime','InteractiveDegree', 'Daysection', 'Dayofweek']]\n",
        "    return X"
      ],
      "metadata": {
        "id": "7Wq6_8wbT5Qn"
      },
      "id": "7Wq6_8wbT5Qn",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "X_test = FeatureEngineering(adX_test)  \n",
        "\n",
        "\n",
        "## inputs and test sets\n",
        "[X_input.shape, X_test.shape, y_input.shape, y_test.shape]"
      ],
      "metadata": {
        "id": "S7YrU8SCT6Tt",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "b64658dc-7760-4b6e-b772-56c58d8daec7"
      },
      "id": "S7YrU8SCT6Tt",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "[(750000, 8), (250000, 8), (750000,), (250000,)]"
            ]
          },
          "metadata": {},
          "execution_count": 48
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# MACHINE LERNING MODEL DEVELOPMENT"
      ],
      "metadata": {
        "id": "jS_NYPzknpuL"
      },
      "id": "jS_NYPzknpuL"
    },
    {
      "cell_type": "code",
      "source": [
        "## Use randomforest\n",
        "\n",
        "from sklearn.ensemble import RandomForestClassifier\n",
        "from sklearn.preprocessing import OneHotEncoder\n",
        "ros = RandomOverSampler(random_state=42)\n",
        "##X_resampled_click, y_resampled_click = ros.fit_resample(X_input_click, y_input_click)\n",
        "from sklearn.decomposition import PCA\n",
        "\n",
        "\n",
        "## use GridSearch to tune the hyperparameters\n",
        "pipe = Pipeline([\n",
        "    ('OHE', OneHotEncoder()),\n",
        "      ##('Smote',SMOTE()),\n",
        "        ##('o', ros), \n",
        "        ('u', RandomUnderSampler()),\n",
        "     ##('scaling', MaxAbsScaler()),\n",
        "     ##('scaling', RobustScaler()),\n",
        "     ##('scaling', StandardScaler(with_mean=False)),\n",
        "    ##('simpleimputer', SimpleImputer()),\n",
        "    ##('DT', DecisionTreeClassifier())\n",
        "    ##('LR', LogisticRegression())\n",
        "    ##('PCA', PCA(0.9)),\n",
        "    ('rf', RandomForestClassifier())\n",
        "    \n",
        "        \n",
        "])\n",
        "\n",
        "parameters = {\n",
        "    'u__sampling_strategy':[0.8],\n",
        "    ##'clf__dt__max_depth':  [10, 20],\n",
        "    ##'clf__knn__n_neighbors': [5, 7],\n",
        "    ##'clf__lr__penalty':  ['l2'],\n",
        "    ##'clf__lr__C':  [20.0, 5.0, 1.0],\n",
        "    'rf__max_depth':  [10,20],\n",
        "    ##'clf__xgb__max_depth':  [3,5],\n",
        "    ##'LR__solver': ['newton-cg', 'lbfgs', 'liblinear', 'sag', 'saga' ]\n",
        "}\n",
        "\n",
        "\n",
        "gs = GridSearchCV(pipe, parameters, cv=3, scoring='f1', n_jobs=2, verbose=4)\n",
        "\n",
        "gs.fit(X_input, y_input)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "e3gD1ZaG34wr",
        "outputId": "27b170ae-c2eb-4e00-faac-332342ba34a3"
      },
      "id": "e3gD1ZaG34wr",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Fitting 3 folds for each of 2 candidates, totalling 6 fits\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "GridSearchCV(cv=3,\n",
              "             estimator=Pipeline(steps=[('OHE', OneHotEncoder()),\n",
              "                                       ('u', RandomUnderSampler()),\n",
              "                                       ('rf', RandomForestClassifier())]),\n",
              "             n_jobs=2,\n",
              "             param_grid={'rf__max_depth': [10, 20],\n",
              "                         'u__sampling_strategy': [0.8]},\n",
              "             scoring='f1', verbose=4)"
            ]
          },
          "metadata": {},
          "execution_count": 34
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "d75fae0f",
      "metadata": {
        "id": "d75fae0f"
      },
      "outputs": [],
      "source": [
        "from sklearn.ensemble import StackingClassifier\n",
        "from sklearn.ensemble import RandomForestClassifier\n",
        "from sklearn.neighbors import KNeighborsClassifier\n",
        "from xgboost import XGBClassifier\n",
        "\n",
        "\n",
        "estimators = [\n",
        "    ##('knn', KNeighborsClassifier(n_neighbors=5)),\n",
        "    ##('dt', DecisionTreeClassifier()),\n",
        "    ##('lr', LogisticRegression()),\n",
        "    ('rf', RandomForestClassifier()),\n",
        "    ('xgb', XGBClassifier(max_depth=3,min_child_weight=1.5))\n",
        "]\n",
        "\n",
        "clf = StackingClassifier(\n",
        "    estimators=estimators, final_estimator=LogisticRegression(penalty='l2',C=5)\n",
        ")"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        ""
      ],
      "metadata": {
        "id": "iU1j_-hk33aN"
      },
      "id": "iU1j_-hk33aN",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "7d8aa92e",
      "metadata": {
        "id": "7d8aa92e",
        "outputId": "68ecf337-0d94-4391-98bc-27b62ad24b2a",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 395
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Fitting 3 folds for each of 24 candidates, totalling 72 fits\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "KeyboardInterrupt",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-50-e1b7ff8cc472>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     36\u001b[0m \u001b[0mgs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mGridSearchCV\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpipe\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparameters\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mscoring\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'f1'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mverbose\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m4\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     37\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 38\u001b[0;31m \u001b[0mgs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_input\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_input\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     39\u001b[0m \u001b[0;31m## not enough time to finish running this\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_search.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, groups, **fit_params)\u001b[0m\n\u001b[1;32m    889\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mresults\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    890\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 891\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_run_search\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mevaluate_candidates\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    892\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    893\u001b[0m             \u001b[0;31m# multimetric is determined here because in the case of a callable\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_search.py\u001b[0m in \u001b[0;36m_run_search\u001b[0;34m(self, evaluate_candidates)\u001b[0m\n\u001b[1;32m   1390\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_run_search\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mevaluate_candidates\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1391\u001b[0m         \u001b[0;34m\"\"\"Search all candidates in param_grid\"\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1392\u001b[0;31m         \u001b[0mevaluate_candidates\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mParameterGrid\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mparam_grid\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1393\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1394\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/model_selection/_search.py\u001b[0m in \u001b[0;36mevaluate_candidates\u001b[0;34m(candidate_params, cv, more_results)\u001b[0m\n\u001b[1;32m    849\u001b[0m                     )\n\u001b[1;32m    850\u001b[0m                     for (cand_idx, parameters), (split_idx, (train, test)) in product(\n\u001b[0;32m--> 851\u001b[0;31m                         \u001b[0menumerate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcandidate_params\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0menumerate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgroups\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    852\u001b[0m                     )\n\u001b[1;32m    853\u001b[0m                 )\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, iterable)\u001b[0m\n\u001b[1;32m   1054\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1055\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieval_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1056\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieve\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1057\u001b[0m             \u001b[0;31m# Make sure that we get a last message telling us we are done\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1058\u001b[0m             \u001b[0melapsed_time\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtime\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_start_time\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36mretrieve\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    933\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    934\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'supports_timeout'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 935\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    936\u001b[0m                 \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    937\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjob\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.7/dist-packages/joblib/_parallel_backends.py\u001b[0m in \u001b[0;36mwrap_future_result\u001b[0;34m(future, timeout)\u001b[0m\n\u001b[1;32m    540\u001b[0m         AsyncResults.get from multiprocessing.\"\"\"\n\u001b[1;32m    541\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 542\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfuture\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    543\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mCfTimeoutError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    544\u001b[0m             \u001b[0;32mraise\u001b[0m \u001b[0mTimeoutError\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/concurrent/futures/_base.py\u001b[0m in \u001b[0;36mresult\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    428\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__get_result\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    429\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 430\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_condition\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    431\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    432\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_state\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mCANCELLED\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mCANCELLED_AND_NOTIFIED\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/lib/python3.7/threading.py\u001b[0m in \u001b[0;36mwait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    294\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m    \u001b[0;31m# restore state no matter what (e.g., KeyboardInterrupt)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    295\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 296\u001b[0;31m                 \u001b[0mwaiter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0macquire\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    297\u001b[0m                 \u001b[0mgotit\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    298\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          ]
        }
      ],
      "source": [
        "from sklearn.preprocessing import OneHotEncoder\n",
        "ros = RandomOverSampler(random_state=42)\n",
        "##X_resampled_click, y_resampled_click = ros.fit_resample(X_input_click, y_input_click)\n",
        "from sklearn.decomposition import PCA\n",
        "from sklearn.preprocessing import MaxAbsScaler\n",
        "## use GridSearch to tune the hyperparameters\n",
        "pipe = Pipeline([\n",
        "    ('OHE', OneHotEncoder()),\n",
        "      ##('Smote',SMOTE()),\n",
        "        ##('o', ros), \n",
        "        ('u', RandomUnderSampler()),\n",
        "     ('scaling', MaxAbsScaler()),\n",
        "     ##('scaling', RobustScaler()),\n",
        "     ##('scaling', StandardScaler(with_mean=False)),\n",
        "    ##('simpleimputer', SimpleImputer()),\n",
        "    ##('DT', DecisionTreeClassifier())\n",
        "    ##('LR', LogisticRegression())\n",
        "    ##('PCA', PCA(0.9)),\n",
        "    ('clf', clf)\n",
        "    \n",
        "        \n",
        "])\n",
        "\n",
        "parameters = {\n",
        "    'u__sampling_strategy':[0.8,0.5,0.3],\n",
        "    ##'clf__dt__max_depth':  [10, 20],\n",
        "    ##'clf__knn__n_neighbors': [5, 7],\n",
        "    ##'clf__lr__penalty':  ['l2'],\n",
        "    ##'clf__lr__C':  [20.0, 5.0, 1.0],\n",
        "    'clf__rf__max_depth':  [10,20,30,50],\n",
        "    'clf__xgb__max_depth':  [3,5],\n",
        "    ##'LR__solver': ['newton-cg', 'lbfgs', 'liblinear', 'sag', 'saga' ]\n",
        "}\n",
        "\n",
        "\n",
        "gs = GridSearchCV(pipe, parameters, cv=3, scoring='f1', n_jobs=2, verbose=4)\n",
        "\n",
        "gs.fit(X_input, y_input)\n",
        "## not enough time to finish running this"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.preprocessing import OneHotEncoder\n",
        "ros = RandomOverSampler(random_state=42)\n",
        "##X_resampled_click, y_resampled_click = ros.fit_resample(X_input_click, y_input_click)\n",
        "from sklearn.decomposition import PCA\n",
        "\n",
        "## use GridSearch to tune the hyperparameters\n",
        "pipe = Pipeline([\n",
        "      ('OHE', OneHotEncoder()),\n",
        "      ##('Smote',SMOTE()),\n",
        "        ('o', ros), \n",
        "        ##('u', rus),\n",
        "     ## ('scaling', MaxAbsScaler()),\n",
        "     ##('scaling', RobustScaler()),\n",
        "     ##('scaling', StandardScaler(with_mean=False)),\n",
        "    ##('simpleimputer', SimpleImputer()),\n",
        "    ##('DT', DecisionTreeClassifier())\n",
        "    ##('LR', LogisticRegression())\n",
        "    ##('PCA', PCA(0.9)),\n",
        "    ('lr', LogisticRegression())\n",
        "    \n",
        "        \n",
        "])\n",
        "\n",
        "parameters = {\n",
        "    'o__sampling_strategy':[0.8],\n",
        "    ##'clf__dt__max_depth':  [10, 20],\n",
        "    ##'clf__knn__n_neighbors': [5, 7],\n",
        "    'lr__penalty':  ['l2'],\n",
        "    'lr__C':  [5.0,20],\n",
        "    ##'lr_max_iter':[50,100]\n",
        "}\n",
        "\n",
        "\n",
        "gs = GridSearchCV(pipe, parameters, cv=3, scoring='f1', n_jobs=2, verbose=4)\n",
        "\n",
        "gs.fit(X_input, y_input)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "AR8RCoADEFns",
        "outputId": "06907000-8da5-4e81-eb85-f0d3af00d0ea"
      },
      "id": "AR8RCoADEFns",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Fitting 3 folds for each of 2 candidates, totalling 6 fits\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "GridSearchCV(cv=3,\n",
              "             estimator=Pipeline(steps=[('OHE', OneHotEncoder()),\n",
              "                                       ('o',\n",
              "                                        RandomOverSampler(random_state=42)),\n",
              "                                       ('lr', LogisticRegression())]),\n",
              "             n_jobs=2,\n",
              "             param_grid={'lr__C': [5.0, 20], 'lr__penalty': ['l2'],\n",
              "                         'o__sampling_strategy': [0.8]},\n",
              "             scoring='f1', verbose=4)"
            ]
          },
          "metadata": {},
          "execution_count": 45
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "ce1ffd26",
      "metadata": {
        "id": "ce1ffd26",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "f816acad-27e7-46f3-f7b1-65170c3c6a5c"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "{'clf__rf__max_depth': 10,\n",
              " 'clf__xgb__max_depth': 3,\n",
              " 'u__sampling_strategy': 0.3}"
            ]
          },
          "metadata": {},
          "execution_count": 42
        }
      ],
      "source": [
        "gs.best_params_\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "a00ab6a0",
      "metadata": {
        "id": "a00ab6a0"
      },
      "outputs": [],
      "source": [
        "best_model = gs.best_estimator_\n"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#define a default treshold 0.5 probability for identification\n",
        "def treshold(pred):\n",
        "    if pred <= 0.5:\n",
        "        return 0\n",
        "    else:\n",
        "        return 1\n",
        "\n",
        "## develop a function which evaluates the model using  4 different matrices\n",
        "def assess_model(model):\n",
        "    predictions = model.predict(X_test)\n",
        "    accuracy = accuracy_score(y_test, predictions)\n",
        "    print('Accuracy: %f' % accuracy)\n",
        "    print()\n",
        "    f1 = f1_score(y_test, predictions)\n",
        "    print('F1 score: %f' % f1)\n",
        "    print()\n",
        "    precision = precision_score(y_test, predictions)\n",
        "    print('Precision_score : %f' % precision)\n",
        "    print()\n",
        "    recall = recall_score(y_test, predictions)\n",
        "    print('Recall_score: %f' % recall)\n",
        "    print()\n",
        "    print('Confusion matrix')\n",
        "    cm = confusion_matrix(y_true=y_test, y_pred=predictions)\n",
        "    print(cm)"
      ],
      "metadata": {
        "id": "NKmY4uhk_9QG"
      },
      "id": "NKmY4uhk_9QG",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "assess_model(best_model)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "QYzdNXkgAFHO",
        "outputId": "228ff99e-7bf6-499e-c3a9-e6b1242aada0"
      },
      "id": "QYzdNXkgAFHO",
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Accuracy: 0.991668\n",
            "\n",
            "F1 score: 0.003826\n",
            "\n",
            "Precision_score : 0.001983\n",
            "\n",
            "Recall_score: 0.054054\n",
            "\n",
            "Confusion matrix\n",
            "[[247913   2013]\n",
            " [    70      4]]\n"
          ]
        }
      ]
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.8.8"
    },
    "colab": {
      "name": "CTR ordinal approach by Lin Xie.ipynb",
      "provenance": [],
      "collapsed_sections": [],
      "toc_visible": true
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}
